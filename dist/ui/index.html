<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Apps Script Parallels</title>
    <script type="module" crossorigin>
(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();function p(){}const Ce=e=>e;function te(e,t){for(const n in t)e[n]=t[n];return e}function de(e){return e()}function ne(){return Object.create(null)}function E(e){e.forEach(de)}function he(e){return typeof e=="function"}function j(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function Ie(e){return Object.keys(e).length===0}function $e(e,...t){if(e==null)return p;const n=e.subscribe(...t);return n.unsubscribe?()=>n.unsubscribe():n}function Re(e,t,n){e.$$.on_destroy.push($e(t,n))}const ge=typeof window<"u";let Se=ge?()=>window.performance.now():()=>Date.now(),pe=ge?e=>requestAnimationFrame(e):p;const R=new Set;function me(e){R.forEach(t=>{t.c(e)||(R.delete(t),t.f())}),R.size!==0&&pe(me)}function Ae(e){let t;return R.size===0&&pe(me),{promise:new Promise(n=>{R.add(t={c:e,f:n})}),abort(){R.delete(t)}}}function v(e,t){e.appendChild(t)}function k(e,t,n){e.insertBefore(t,n||null)}function b(e){e.parentNode&&e.parentNode.removeChild(e)}function Q(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function w(e){return document.createElement(e)}function _e(e){return document.createTextNode(e)}function re(){return _e(" ")}function Ee(){return _e("")}function oe(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function A(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function ke(e){return Array.from(e.childNodes)}function _(e,t,n,o){n==null?e.style.removeProperty(t):e.style.setProperty(t,n,o?"important":"")}function qe(e,t,n){e.classList[n?"add":"remove"](t)}let M;function P(e){M=e}function Ge(){if(!M)throw new Error("Function called outside component initialization");return M}function ve(e){Ge().$$.on_mount.push(e)}const $=[],N=[];let S=[];const X=[],Pe=Promise.resolve();let K=!1;function Me(){K||(K=!0,Pe.then(we))}function U(e){S.push(e)}function Ne(e){X.push(e)}const B=new Set;let C=0;function we(){if(C!==0)return;const e=M;do{try{for(;C<$.length;){const t=$[C];C++,P(t),ze(t.$$)}}catch(t){throw $.length=0,C=0,t}for(P(null),$.length=0,C=0;N.length;)N.pop()();for(let t=0;t<S.length;t+=1){const n=S[t];B.has(n)||(B.add(n),n())}S.length=0}while($.length);for(;X.length;)X.pop()();K=!1,B.clear(),P(e)}function ze(e){if(e.fragment!==null){e.update(),E(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(U)}}function je(e){const t=[],n=[];S.forEach(o=>e.indexOf(o)===-1?t.push(o):n.push(o)),n.forEach(o=>o()),S=t}const D=new Set;let y;function Oe(){y={r:0,c:[],p:y}}function Te(){y.r||E(y.c),y=y.p}function x(e,t){e&&e.i&&(D.delete(e),e.i(t))}function z(e,t,n,o){if(e&&e.o){if(D.has(e))return;D.add(e),y.c.push(()=>{D.delete(e),o&&(n&&e.d(1),o())}),e.o(t)}else o&&o()}function Le(e,t,n){const o=e.$$.props[t];o!==void 0&&(e.$$.bound[o]=n,n(e.$$.ctx[o]))}function ee(e){e&&e.c()}function F(e,t,n,o){const{fragment:r,after_update:s}=e.$$;r&&r.m(t,n),o||U(()=>{const i=e.$$.on_mount.map(de).filter(he);e.$$.on_destroy?e.$$.on_destroy.push(...i):E(i),e.$$.on_mount=[]}),s.forEach(U)}function V(e,t){const n=e.$$;n.fragment!==null&&(je(n.after_update),E(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function De(e,t){e.$$.dirty[0]===-1&&($.push(e),Me(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function H(e,t,n,o,r,s,i,l=[-1]){const c=M;P(e);const u=e.$$={fragment:null,ctx:[],props:s,update:p,not_equal:r,bound:ne(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(c?c.$$.context:[])),callbacks:ne(),dirty:l,skip_bound:!1,root:t.target||c.$$.root};i&&i(u.root);let d=!1;if(u.ctx=n?n(e,t.props||{},(a,h,...f)=>{const g=f.length?f[0]:h;return u.ctx&&r(u.ctx[a],u.ctx[a]=g)&&(!u.skip_bound&&u.bound[a]&&u.bound[a](g),d&&De(e,a)),h}):[],u.update(),d=!0,E(u.before_update),u.fragment=o?o(u.ctx):!1,t.target){if(t.hydrate){const a=ke(t.target);u.fragment&&u.fragment.l(a),a.forEach(b)}else u.fragment&&u.fragment.c();t.intro&&x(e.$$.fragment),F(e,t.target,t.anchor,t.customElement),we()}P(c)}class W{$destroy(){V(this,1),this.$destroy=p}$on(t,n){if(!he(n))return p;const o=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return o.push(n),()=>{const r=o.indexOf(n);r!==-1&&o.splice(r,1)}}$set(t){this.$$set&&!Ie(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}let ye=window.hasOwnProperty("google");async function Fe(e,t,...n){return ye?new Promise((o,r)=>{google.script.run.withSuccessHandler(o).withFailureHandler(r)[e](...n)}):Ve(t)}function Ve(e){const o=Math.floor(Math.random()*601)+300;return new Promise(r=>{setTimeout(()=>{r(e)},o)})}function He(e){var t=async()=>{let n;try{n=await Fe(e.functionName,e.dummyReturn,...e.args)}catch(o){e.reject(o)}e.resolve(n)};return t}function We(e){return-e*(e-2)}const I=[];function Be(e,t=p){let n;const o=new Set;function r(l){if(j(e,l)&&(e=l,n)){const c=!I.length;for(const u of o)u[1](),I.push(u,e);if(c){for(let u=0;u<I.length;u+=2)I[u][0](I[u+1]);I.length=0}}}function s(l){r(l(e))}function i(l,c=p){const u=[l,c];return o.add(u),o.size===1&&(n=t(r)||p),l(e),()=>{o.delete(u),o.size===0&&n&&(n(),n=null)}}return{set:r,update:s,subscribe:i}}function ie(e){return Object.prototype.toString.call(e)==="[object Date]"}function Y(e,t){if(e===t||e!==e)return()=>e;const n=typeof e;if(n!==typeof t||Array.isArray(e)!==Array.isArray(t))throw new Error("Cannot interpolate values of different type");if(Array.isArray(e)){const o=t.map((r,s)=>Y(e[s],r));return r=>o.map(s=>s(r))}if(n==="object"){if(!e||!t)throw new Error("Object cannot be null");if(ie(e)&&ie(t)){e=e.getTime(),t=t.getTime();const s=t-e;return i=>new Date(e+i*s)}const o=Object.keys(t),r={};return o.forEach(s=>{r[s]=Y(e[s],t[s])}),s=>{const i={};return o.forEach(l=>{i[l]=r[l](s)}),i}}if(n==="number"){const o=t-e;return r=>e+r*o}throw new Error(`Cannot interpolate ${n} values`)}function Xe(e,t={}){const n=Be(e);let o,r=e;function s(i,l){if(e==null)return n.set(e=i),Promise.resolve();r=i;let c=o,u=!1,{delay:d=0,duration:a=400,easing:h=Ce,interpolate:f=Y}=te(te({},t),l);if(a===0)return c&&(c.abort(),c=null),n.set(e=r),Promise.resolve();const g=Se()+d;let q;return o=Ae(O=>{if(O<g)return!0;u||(q=f(e,i),typeof a=="function"&&(a=a(e,i)),u=!0),c&&(c.abort(),c=null);const G=O-g;return G>a?(n.set(e=i),!1):(n.set(e=q(h(G/a))),!0)}),o.promise}return{set:s,update:(i,l)=>s(i(r,e),l),subscribe:n.subscribe}}function se(e,t,n){const o=e.slice();return o[11]=t[n],o[13]=n,o}function le(e,t,n){const o=e.slice();return o[14]=t[n],o[16]=n,o}function ce(e){let t;return{c(){t=w("div"),A(t,"class","cell svelte-2y52ej"),_(t,"background-color",e[14])},m(n,o){k(n,t,o)},p(n,o){o&4&&_(t,"background-color",n[14])},d(n){n&&b(t)}}}function ue(e){let t,n=e[11],o=[];for(let r=0;r<n.length;r+=1)o[r]=ce(le(e,n,r));return{c(){for(let r=0;r<o.length;r+=1)o[r].c();t=Ee()},m(r,s){for(let i=0;i<o.length;i+=1)o[i]&&o[i].m(r,s);k(r,t,s)},p(r,s){if(s&4){n=r[11];let i;for(i=0;i<n.length;i+=1){const l=le(r,n,i);o[i]?o[i].p(l,s):(o[i]=ce(l),o[i].c(),o[i].m(t.parentNode,t))}for(;i<o.length;i+=1)o[i].d(1);o.length=n.length}},d(r){Q(o,r),r&&b(t)}}}function Ke(e){let t,n=e[2],o=[];for(let r=0;r<n.length;r+=1)o[r]=ue(se(e,n,r));return{c(){t=w("div");for(let r=0;r<o.length;r+=1)o[r].c();A(t,"class","grid-container svelte-2y52ej"),_(t,"--grid-columns",e[0]),_(t,"--pixel-size",e[1])},m(r,s){k(r,t,s);for(let i=0;i<o.length;i+=1)o[i]&&o[i].m(t,null)},p(r,[s]){if(s&4){n=r[2];let i;for(i=0;i<n.length;i+=1){const l=se(r,n,i);o[i]?o[i].p(l,s):(o[i]=ue(l),o[i].c(),o[i].m(t,null))}for(;i<o.length;i+=1)o[i].d(1);o.length=n.length}s&1&&_(t,"--grid-columns",r[0]),s&2&&_(t,"--pixel-size",r[1])},i:p,o:p,d(r){r&&b(t),Q(o,r)}}}function Ue(e,t,n){let o,{colorGrid:r=null}=t,{h:s=10}=t,{w:i=10}=t,{pixelSize:l="3px"}=t;function c(){a.set(0),a.set(100)}let u=[];const d=s*i,a=Xe(0,{duration:150,easing:We});Re(e,a,g=>n(7,o=g));function h(g){let q=Math.ceil(g/i),O=g-(q-1)*i,G="#7e7efd";for(let T=0;T<q;T++)for(let L=0;L<O;L++)r&&(G=r[T][L]),n(2,u[T][L]=G,u)}function f(){for(let g=0;g<s;g++)n(2,u[g]=Array(i).fill("#f8f1d2"),u)}return f(),e.$$set=g=>{"colorGrid"in g&&n(4,r=g.colorGrid),"h"in g&&n(5,s=g.h),"w"in g&&n(0,i=g.w),"pixelSize"in g&&n(1,l=g.pixelSize)},e.$$.update=()=>{if(e.$$.dirty&128){let g=Math.ceil(o/100*d);o&&h(g)}},[i,l,u,a,r,s,c,o]}class Ye extends W{constructor(t){super(),H(this,t,Ue,Ke,j,{colorGrid:4,h:5,w:0,pixelSize:1,paintSquares:6})}get paintSquares(){return this.$$.ctx[6]}}function m(e){return typeof e>"u"}function Ze(e){e.width=e.endColumnIndex-e.startColumnIndex,e.height=e.endRowIndex-e.startRowIndex}function Je(e,t){if(t<0)return[e];t=Math.round(t),t%2!==0&&t--;const n=xe(e),o=n.endColumnIndex-n.startColumnIndex,r=n.endRowIndex-n.startRowIndex;return Qe(r,o,t)}function Qe(e,t,n){const o=e/t;let r=Math.floor(e/Math.sqrt(n)/o),s=Math.floor(t/Math.sqrt(n)*o);e%Math.sqrt(n)!==0&&r++,t%Math.sqrt(n)!==0&&s++;let i=[],l=[];for(let c=0;c<e;c+=r){l=[];for(let u=0;u<t;u+=s)l.push({startRowIndex:c,startColumnIndex:u,endRowIndex:c+Math.min(r,e-c),endColumnIndex:u+Math.min(s,t-u)});i.push(l)}return i}function xe(e,t=""){const{col:n,row:o}=e.toUpperCase().split("!").map(l=>l.split(":")).pop().reduce((l,c)=>{var[u,d]=["[A-Z]+","[0-9]+"].map(a=>c.match(new RegExp(a)));return l.col.push(u&&tt(u[0])),l.row.push(d&&Number(d[0])),l},{col:[],row:[]});n.sort((l,c)=>l>c?1:-1),o.sort((l,c)=>l>c?1:-1);const[r,s]=n.map((l,c)=>({col:l,row:o[c]})),i={startRowIndex:(r==null?void 0:r.row)&&r.row-1,endRowIndex:s!=null&&s.row?s.row:r.row,startColumnIndex:r&&r.col,endColumnIndex:s?s.col+1:1};return i.startRowIndex===null&&(i.startRowIndex=0,delete i.endRowIndex),i.startColumnIndex===null&&(i.startColumnIndex=0,delete i.endColumnIndex),t!==""&&(i.sheetName=t),i}function et(e,t=!1){if(!e)throw"gridrange is required parameter";let{startRowIndex:n,endRowIndex:o,startColumnIndex:r,endColumnIndex:s}=e;m(o)&&(o=n+1),m(s)&&(s=r+1);var i="";t&&(i="$");const l={},c={};m(r)?m(r)&&!m(s)&&(l.col="A"):l.col=Z(r),m(n)?m(n)&&!m(o)&&(l.row=o):l.row=n+1,c.col=Z(s-1),c.row=o,l.col=i+l.col,l.row=i+l.row,c.col=i+c.col,c.row=i+c.row;const u=["col","row"],d=u.map(f=>l[f]).join(""),a=u.map(f=>c[f]).join("");return d==a?d:`${d}:${a}`}function tt(e=null){return e=e.toUpperCase(),[...e].reduce((t,n,o,r)=>t+=(n.charCodeAt(0)-64)*Math.pow(26,r.length-o-1),-1)}function Z(e=null){var t;return(t=Math.floor(e/26))>=0?Z(t-1)+String.fromCharCode(65+e%26):""}function be(e,t,n){const o=[];for(let r=0;r<e;r++){const s=Array(t).fill(n);o.push(s)}return o}const nt=300-15*2,rt=500,J={reset:"#f8f1d2",chess1:"#F4EAE7",chess2:"#4A648B"};function ot(e){const t=xe(e),n=t.endColumnIndex-t.startColumnIndex,r=(t.endRowIndex-t.startRowIndex)*n,s=Math.round(r/rt/10)*10,i=nt/n+"px";let l=Je(e,s),c=l.flat(1);c.forEach(Ze);let u=l[0].length,d=c.map(it.bind(null,u)),a=c.map(st);const h=c.map(f=>et(f));return{squaresWidth:u,pixelSize:i,gridsArray:c,gridColors:d,gridDefaultColors:a,gridChessColors:d,a1Ranges:h}}function it(e,t,n){let o=lt(n,e);return be(t.height,t.width,o)}function st(e){const t=J.reset;return be(e.height,e.width,t)}function lt(e,t){const n=Math.floor(e/t),o=e%t,r=n%2===0,s=o%2===0;return r&&s||!r&&!s?J.chess1:J.chess2}function ae(e,t,n){const o=e.slice();return o[9]=t[n],o[10]=t,o[11]=n,o}function fe(e){let t,n=e[11],o,r;const s=()=>e[7](t,n),i=()=>e[7](null,n);function l(u){e[8](u,e[11])}let c={w:e[9].width,h:e[9].height,pixelSize:e[0].pixelSize};return e[0].gridColors[e[11]]!==void 0&&(c.colorGrid=e[0].gridColors[e[11]]),t=new Ye({props:c}),s(),N.push(()=>Le(t,"colorGrid",l)),{c(){ee(t.$$.fragment)},m(u,d){F(t,u,d),r=!0},p(u,d){e=u,n!==e[11]&&(i(),n=e[11],s());const a={};d&1&&(a.w=e[9].width),d&1&&(a.h=e[9].height),d&1&&(a.pixelSize=e[0].pixelSize),!o&&d&1&&(o=!0,a.colorGrid=e[0].gridColors[e[11]],Ne(()=>o=!1)),t.$set(a)},i(u){r||(x(t.$$.fragment,u),r=!0)},o(u){z(t.$$.fragment,u),r=!1},d(u){i(),V(t,u)}}}function ct(e){let t,n,o=e[0].gridsArray,r=[];for(let i=0;i<o.length;i+=1)r[i]=fe(ae(e,o,i));const s=i=>z(r[i],1,1,()=>{r[i]=null});return{c(){t=w("div");for(let i=0;i<r.length;i+=1)r[i].c();A(t,"class","grid-container svelte-1bmmeax"),_(t,"--grid-columns",e[0].squaresWidth)},m(i,l){k(i,t,l);for(let c=0;c<r.length;c+=1)r[c]&&r[c].m(t,null);n=!0},p(i,[l]){if(l&3){o=i[0].gridsArray;let c;for(c=0;c<o.length;c+=1){const u=ae(i,o,c);r[c]?(r[c].p(u,l),x(r[c],1)):(r[c]=fe(u),r[c].c(),x(r[c],1),r[c].m(t,null))}for(Oe(),c=o.length;c<r.length;c+=1)s(c);Te()}(!n||l&1)&&_(t,"--grid-columns",i[0].squaresWidth)},i(i){if(!n){for(let l=0;l<o.length;l+=1)x(r[l]);n=!0}},o(i){r=r.filter(Boolean);for(let l=0;l<r.length;l+=1)z(r[l]);n=!1},d(i){i&&b(t),Q(r,i)}}}function ut(e,t,n){let{data:o={ssId:"1tS0HIxwHLL_4MKYmc-wRXl3Msb4zV13V6jX7NnWFCu8",sheetName:"Image1Colors",rangeAddress:"A1:FC240"}}=t,r=ot(o.rangeAddress),s=[];const i=r.a1Ranges,l=r.gridChessColors;function c(){n(0,r.gridColors=r.gridDefaultColors,r),s.forEach(h=>h.paintSquares())}function u(h,f){f=f||r.gridChessColors[h],n(0,r.gridColors[h]=f,r),s[h].paintSquares()}function d(h,f){N[h?"unshift":"push"](()=>{s[f]=h,n(1,s)})}function a(h,f){e.$$.not_equal(r.gridColors[f],h)&&(r.gridColors[f]=h,n(0,r))}return e.$$set=h=>{"data"in h&&n(2,o=h.data)},[r,s,o,i,l,c,u,d,a]}class at extends W{constructor(t){super(),H(this,t,ut,ct,j,{data:2,a1Ranges:3,mockResultValues:4,reset:5,paintSquare:6})}get a1Ranges(){return this.$$.ctx[3]}get mockResultValues(){return this.$$.ctx[4]}get reset(){return this.$$.ctx[5]}get paintSquare(){return this.$$.ctx[6]}}async function ft(e,t=10){const n=[];async function o(i){for(const[l,c]of i)await r(l,c),console.log(l,"done")}async function r(i,l){n[i]=await l()}const s=new Array(t).fill(e.entries()).map(o);return await Promise.allSettled(s),n}function dt(e){let t,n,o,r,s,i,l,c,u,d={data:e[1]};return i=new at({props:d}),e[4](i),{c(){t=w("div"),n=w("button"),n.textContent="Paint squares",o=re(),r=w("button"),r.textContent="Reset Colors",s=re(),ee(i.$$.fragment),A(t,"class","block svelte-1m73794")},m(a,h){k(a,t,h),v(t,n),v(t,o),v(t,r),v(t,s),F(i,t,null),l=!0,c||(u=[oe(n,"click",e[2]),oe(r,"click",e[3])],c=!0)},p(a,[h]){const f={};i.$set(f)},i(a){l||(x(i.$$.fragment,a),l=!0)},o(a){z(i.$$.fragment,a),l=!1},d(a){a&&b(t),e[4](null),V(i),c=!1,E(u)}}}function ht(e,t,n){const o={ssId:"1tS0HIxwHLL_4MKYmc-wRXl3Msb4zV13V6jX7NnWFCu8",sheetName:"Image1Colors",rangeAddress:"A1:FC240"};let r,s=[],i=[],l,c=[];function u(){if(r){s=r.a1Ranges,i=r.mockResultValues;for(let f=0;f<s.length;f++)l={functionName:"getRangeValues",args:[o.ssId,o.sheetName,s[f]],dummyReturn:i[f],reject:g=>console.log(g),resolve:g=>r.paintSquare(f,g)},c.push(He(l))}}ve(u);function d(){ft(c)}function a(){r.reset()}function h(f){N[f?"unshift":"push"](()=>{r=f,n(0,r)})}return[r,o,d,a,h]}class gt extends W{constructor(t){super(),H(this,t,ht,dt,j,{})}}function pt(e){let t,n,o,r;return o=new gt({}),{c(){t=w("div"),n=w("div"),ee(o.$$.fragment),A(n,"class","content svelte-1uui94g"),A(t,"class","wrapper svelte-1uui94g"),qe(t,"sidebar",!ye)},m(s,i){k(s,t,i),v(t,n),F(o,n,null),r=!0},p,i(s){r||(x(o.$$.fragment,s),r=!0)},o(s){z(o.$$.fragment,s),r=!1},d(s){s&&b(t),V(o)}}}class mt extends W{constructor(t){super(),H(this,t,null,pt,j,{})}}new mt({target:document.getElementById("app")});

</script>
    <style>
.grid-container.svelte-2y52ej{display:inline-grid;grid-template-columns:repeat(var(--grid-columns),1fr);gap:0}.cell.svelte-2y52ej{width:var(--pixel-size);height:var(--pixel-size)}.grid-container.svelte-1bmmeax{display:inline-grid;grid-template-columns:repeat(var(--grid-columns),min-content);gap:0}.block.svelte-1m73794{display:block}.wrapper.svelte-1uui94g{overflow-x:auto;width:100%;height:100%;max-width:300px}.sidebar.svelte-1uui94g{position:fixed;right:0;top:0;bottom:0;border:1px solid bisque}.content.svelte-1uui94g{padding:15px;display:flex}

</style>
  </head>
  <body>
    <div id="app"></div>
    
  </body>
</html>
